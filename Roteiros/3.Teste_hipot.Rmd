---
title: "Prática 3: Teste de Hipóteses"
author: "Guillermo Florez Montero e Otávio César Marchetti"
date: "`Julho de 2021`"
output:
  prettydoc::html_pretty:
    theme: lumen
---

$~$

> Nesta prática vamos usar a teoría estatística que aprendemos nas práticas anteriores para [Testar Hipóteses](https://pt.wikipedia.org/wiki/Testes_de_hip%C3%B3teses). O nosso foco será um tipo de contraste bastante básico porém muito utilizado que é baseado na **diferença entre médias de grupos distintos**. 
>
> Usaremos dois enfoques, o primeiro e o teste a través da construção de [intervalos de confiança](https://pt.wikipedia.org/wiki/Intervalo_de_confian%C3%A7a) para ambas médias, e o segundo será o teste de inferência clássico [t de Student](https://pt.wikipedia.org/wiki/Teste_t_de_Student).

$~$

## Dados e hipótese

Vamos iniciar o nosso exemplo com problema simples de pesquisa.

Queremos saber se o consumo de certo suplemento vitamínico aumenta a massa corporal para medir o uso potencial em pessoas que desejam aumentar a sua massa. Realizou-se um experimento no qual um grupo de participantes com massa inferior à normal e foram tratados com o suplemento ou placebo durante um mes. Mediu-se a massa inicial de cada participante ao início do experimento e a massa depois dos 30 dias de tomar o comprimido. No experimento participaram 80 voluntários do mesmo grupo de idades, 40 tomaram um placebo (grupo controle) e 40 o suplemento (grupo do tratamento). 

Os dados encontram-se neste [link](https://github.com/gflorezm/SemanaBiologiaUFABC_2021/blob/main/Dados/suplemento.RData) só precisam clicar *Download* e salvá-los na pasta do seu projeto do curso. Antes de iniciar, confira que os dados estão salvos na pasta, devería aparecer o arquivo `suplemento.RData`. 

Uma vez salvos vamos ler os dados no ambiente de trabalho usando a função `load()`

```{r ler_dados, eval=FALSE, message=FALSE, warning=FALSE, include=TRUE}
load("suplemento.RData")
```

Ao fazer isso, seus dados são carregados diretamente ao ambiente em um objeto chamado `suplemento`. Confiram a estrutura do *Data frame* usando as funções `View()`, `str()` e `summary()`.

$~$

### Hipóteses estatísticas

Queremos saber se o nosso Suplemento vitamínico tem efeito no ganho (ou perda) de massa corporal. Para isso propomos um sistema de hipóteses estatísticas baseadas na **diferênca de massa (final - inicial)**.

A hipótese nula é que não há diferênça nas medias da diferênça de massa entre o grupo controle (placebo) e o grupo do tratamento (suplemento vitamínico).

A hipótese alternativa é que as médias da diferênça de massa dos grupos é distinta. 

$$ H_0: \mu_{tratmento} = \mu_{controle} $$

$$ H_A: \mu_{tratmento} \ne \mu_{controle} $$
$~$

## Exploração dos dados

A primeira coisa que faremos será calcular a diferênça de massa 
$$\Delta_{massa} = massa_{final} - massa_{inicial}$$

```{r dif massa, eval=FALSE, message=FALSE, warning=FALSE, include=TRUE}
suplemento$dif_massa <- suplemento$massa_final - suplemento$massa_inicial
```

>> Por quê calculamos a diferênça de massa e não usamos diretamente a massa final dos sujeitos?
>> 
>> Quais propriedades tem a diferênça de massa?

Vamos calcular a média e desvio padrão da diferênca de massa usando a função `tapply()` esta função permite aplicar uma outra função sobre um vetór usando um vetór categórico como índice. Um exemplo para a média. Vocês calculam o desvío padrão.

```{r dif media dif, eval=FALSE, message=FALSE, warning=FALSE, include=TRUE}
medias <- tapply(suplemento$dif_massa, suplemento$grupo, mean)

medias # para chamar a saída do objeto
```

> Vendo a saída vocês conseguem saber como a função `tapply()` opera mas vou fazer uma tradução: **R por favor, pega os valores do meu _Data frame_ na variável _diferênça de massa_ e calcula a _média_ separando pelo _grupo_ e salva isso num objeto chamado _medias_.**

$~$

Agora vamos fazer uma exploração gráfica dos dados. Faremos 3 tipos de gráficos exploratórios: 1. histogramas sobrepostos (por grupo), 2. Box Plot e 3. Violin Plot

### 1. Histogramas

```{r histo, eval=FALSE, message=FALSE, warning=FALSE, include=TRUE}

# primeiro para o grupo controle
hist(suplemento$dif_massa[suplemento$grupo == "Controle"], # os valores do grupo Controle
     xlab = "Diferênça de massa", ylab = "Frequência", 
     main = " Histograma da diferênça de massa por grupo",
     probability = TRUE, col = "lightpink", breaks = 11,
     xlim = c(-4,10), ylim = c(0, 0.6))

# adicionamos os do tratamento
hist(suplemento$dif_massa[suplemento$grupo == "Tratamento"], # os valores do grupo Tratamento
     probability = TRUE, col = "lightblue", breaks = 11, add = TRUE)

# Eu gosto dos gráficos fechados então...
box()

# adicionamos umas linhas verticais nas médias
abline(v = medias[1], col = "darkred", lwd = 2.5, lty = 3) # grupo controle
abline(v = medias[2], col = "darkblue", lwd = 2.5, lty = 3) # tratamento

# adicionamos a legenda
legend(7, 0.6, legend = c("Controle", "Tratamento"), bty = "n",
       col=c("lightpink", "lightblue"), pch = 15, pt.cex = 2)
```
